[{"categories":["RNA-seq data analysis","Principles"],"content":"In this section, we are going to learn about the basic principle of DEseq2. The reason to use it and its advantages","date":"2022-05-11","objectID":"/the-basic-principle-of-deseq2/","tags":["RNA-seq data analysis","Principles"],"title":"The basic principle of DESeq2 (1)","uri":"/the-basic-principle-of-deseq2/"},{"categories":["RNA-seq data analysis","Principles"],"content":"How DESeq2 calculated DEGs? DESeq2 tool was published in 2014 and it has been cited more than 30,000 times. (reference) DESeq2 is a method for differential analysis of count data, using shrinkage estimation for dispersions and fold changes to improve the stability and interpretability of estimates. ","date":"2022-05-11","objectID":"/the-basic-principle-of-deseq2/:1:0","tags":["RNA-seq data analysis","Principles"],"title":"The basic principle of DESeq2 (1)","uri":"/the-basic-principle-of-deseq2/"},{"categories":["RNA-seq data analysis","Principles"],"content":"Library normalization by DEGs RPKM, FPKM, TPM‚Ä¶‚Ä¶ Those are methods for adjusting for the difference in overall read counts among libraries. However, DESeq2 does not use those methods! Why? ü§î DESeq2 wanted its normalization to handle those 2 problems: (1) Differences in library sizes (2) Differences in library composition (liver vs spleen) Step 1 Take the log of all the values If we get such count data Gene ID Sample1 Sample2 Sample3 Gene1 A B C Gene2 D E 0 Gene3 X Y Z We than calculated ln(count data)(log base e), and we will get a new table. Gene ID Sample1 Sample2 Sample3 Gene1 ln(A) ln(B) ln(C) Gene2 ln(D) ln(E) error Gene3 ln(X) ln(Y) ln(Z) Notice Notice: if count data=0, In(0) = -inf. DEseq will output NA Step 2 Average each row Gene ID Average of log value Gene 1 [ln(A)+ln(B)+ln(C)]/3 Gene 2 error Gene 3 [ln(X)+ln(Y)+ln(Z)]/3 Which means that only one count=0 will lead to error in the average. Step 3 Filter out genes with error Gene ID Average of log value Gene 1 [ln(A)+ln(B)+ln(C)]/3 Gene 3 [ln(X)+ln(Y)+ln(Z)]/3 Gene 2 is removed! Step 4 Subtract the average log value from the log(counts) Gene ID Sample 1 Sample 2 Sample 3 Gene 1 ln(A)-[ln(A)+ln(B)+ln(C)]/3 ln(B)-[ln(A)+ln(B)+ln(C)]/3 ln(C)-[ln(A)+ln(B)+ln(C)]/3 Gene 2 ln(X)-[ln(X)+ln(Y)+ln(Z)]/3 ln(Y)-[ln(X)+ln(Y)+ln(Z)]/3 ln(Z)-[ln(X)+ln(Y)+ln(Z)]/3 Step 5 Calculate the median of the ratios for each sample Sample 1 Sample 2 Sample 3 median (ln(A)-[ln(A)+ln(B)+ln(C)]/3+ln(X)-[ln(X)+ln(Y)+ln(Z)]/3)/2 (ln(B)-[ln(A)+ln(B)+ln(C)]/3+ln(Y)-[ln(X)+ln(Y)+ln(Z)]/3)/2 (ln(C)-[ln(A)+ln(B)+ln(C)]/3+ln(Z)-[ln(X)+ln(Y)+ln(Z)]/3)/2 Step 6 Calculate the scaling factors (SF) Sample 1 Sample 2 Sample 3 SF e^median(sample1) e^median(sample2) e^median(sample3) Step 7 Divide the original read counts by the scaling factors We will get scaled read counts! Gene ID Sample1 Sample2 Sample3 Gene1 A/SF(Sample1) B/SF(Sample2) C/SF(Sample3) Gene2 D/SF(Sample1) E/SF(Sample2) 0/SF(Sample3) Gene3 X/SF(Sample1) Y/SF(Sample2) Z/SF(Sample3) Logs eliminate all genes that are only transcribed in one sample type. They also help smooth over outlier read counts. The median further downplays genes that soak up a lot of the reads, putting more emphasis on moderately expressed gene. ","date":"2022-05-11","objectID":"/the-basic-principle-of-deseq2/:1:1","tags":["RNA-seq data analysis","Principles"],"title":"The basic principle of DESeq2 (1)","uri":"/the-basic-principle-of-deseq2/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"In this section, we are going to use trim_galore to perform trimming of the read files and improve their qualities","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"Summary In this section, we are going to install trimgalore and trim the merged read files to improve the qualities of read files. ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:0:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"1. Why do we need to trim? Quality trimming decreases the overall number of reads, but increases to the total and proportion of uniquely mapped reads. Thus, you get more useful data for downstream analyses. Too aggressive quality trimming can negatively impact downstream analysis. üë®‚Äçüè´ : Trimming will delete low-quality reads!!! We must trim before mapping!!! üë©‚Äçüè´ : Trimming may delete some important reads!!! Even trash reads are needed for mapping!!! üí° So, whether to trim or not depends on your project and the results of your fastqc results!!! ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:1:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"2. Evaluate the quality of reads using Fastqc The usage of Fastqc has been described before in the last article. ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:2:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"2.1 Per base sequence quality ‚ö†Ô∏è As this figure (per base sequence quality) showed, the last 10 base pairs had low quality, especially the last one ( in the fail bar üî¥). So, I decided to perform trimming for this sample. ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:2:1","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3. Use Trim galore to trim Tip This article is based on the instruction of trim galore. ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:3:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3.1 installing of trim galore download site (github) #Download the tar.gz file of trim galore tar -zxvf 0.6.7.tar.gz trim_galore -version trim_galore --help ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:3:1","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3.2 Run trim galore trim_galore -q 25 --phred 33 --stringency 3 --length 30 --paired 1_R1.fastq.gz 1_R2.fastq.gz --gzip -o./cleandata one paired samples take about 15 min. ‚úîÔ∏è For trimming every sample at once, please refer to this article (Chinese material) for i in 13 14 15 16 17 18 do trim_galore -q 25 --phred 33 --stringency 3 --length 30 --paired /wkdir/${i}_1.fq.gz /wkdir/${i}_2.fq.gz --gzip -o /home/xxx/RNA-seq/trimmed files done ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:3:2","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"4. Run fastqc \u0026 multiqc again After trimming, we need to check the quality again. fastqc *.gz multiqc . The quality becomes higher!!! ‚úåÔ∏è ‚úåÔ∏è ‚úåÔ∏è ","date":"2022-04-08","objectID":"/trim-the-read-files-using-trim_galore/:4:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(2) Trim the read files using trim_galore","uri":"/trim-the-read-files-using-trim_galore/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"In this section, we are going to map the read files to genome index using STAR, perform QC with Qualimap, and obtain count data using featureCounts","date":"2022-04-08","objectID":"/mapping-star-qualimap-featurecounts/","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(3) Mapping (STAR+Qualimap+featureCounts)","uri":"/mapping-star-qualimap-featurecounts/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"Summary In this section, we are going to map the read files to genome index using STAR, perform QC with Qualimap, and obtain count data using featureCounts. ","date":"2022-04-08","objectID":"/mapping-star-qualimap-featurecounts/:0:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(3) Mapping (STAR+Qualimap+featureCounts)","uri":"/mapping-star-qualimap-featurecounts/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"1. installation of STAR Pl ease refer to this official manual # Get latest STAR source from releases wget https://github.com/alexdobin/STAR/archive/2.7.9a.tar.gz tar -xzf 2.7.9a.tar.gz cd STAR-2.7.9a # Compile under Linux cd /STAR-2.7.9a/source make STAR #test STAR ","date":"2022-04-08","objectID":"/mapping-star-qualimap-featurecounts/:1:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(3) Mapping (STAR+Qualimap+featureCounts)","uri":"/mapping-star-qualimap-featurecounts/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"2. Generation of genome index For mapping, the first step that needs to be done is the generation of the genome index. Here, I used the data from Genecode. As I used mouse samples for RNA-seq analysis, I generated mouse genome index this time. #create a new folder named as index mkdir /home/xxx/reference/index #running STAR for the generation of index STAR --runThreadN 10 --runMode genomeGenerate --genomeDir index/ --genomeFastaFiles GRCh38.p13.genome.fa --sjdbGTFfile gencode.v38.annotation.gtf --sjdbOverhang 35 ","date":"2022-04-08","objectID":"/mapping-star-qualimap-featurecounts/:2:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(3) Mapping (STAR+Qualimap+featureCounts)","uri":"/mapping-star-qualimap-featurecounts/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3. Running Mapping using two-pass-mode STAR --runThreadN 10 --runMode alignReads --readFilesCommand zcat --twopassMode Basic --outSAMtype BAM SortedByCoordinate --genomeDir /reference/genome/grcm39/index/ --readFilesIn 2_R1_val_1.fq.gz 2_R2_val_2.fq.gz --outFileNamePrefix /wkdir/WT2Brain one sample takes about 6 minutes Dec 07 18:03:31 ..... started STAR run Dec 07 18:03:31 ..... loading genome Dec 07 18:05:35 ..... started 1st pass mapping Dec 07 18:07:22 ..... finished 1st pass mapping Dec 07 18:07:22 ..... inserting junctions into the genome indices Dec 07 18:08:19 ..... started mapping Dec 07 18:10:16 ..... finished mapping Dec 07 18:10:18 ..... started sorting BAM Dec 07 18:11:13 ..... finished successfully The log.final.out file provides information on reads that 1) mapped uniquely, 2) reads that mapped to mutliple locations and 3) reads that are unmapped. Additionally, we get details on splicing, insertion and deletion. From this file the most informative statistics include the mapping rate and the number of multimappers. ","date":"2022-04-08","objectID":"/mapping-star-qualimap-featurecounts/:3:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(3) Mapping (STAR+Qualimap+featureCounts)","uri":"/mapping-star-qualimap-featurecounts/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"4. QC of mapping using Qualimap In addition to the aligner-specific summary, we can also obtain quality metrics using tools like Qualimap, a Java application that aims to facilitate the quality-control analysis of mapping data. ~/Desktop/qualimap_v2.2.1/qualimap rnaseq -bam /dir/xxx.bam -gtf /dir/annotation.gtf -outdir /dir/WT1 --jav-mem-size=8G Check how many percentages of reads are mapped : Check how many percentages of the reads are exonic: ","date":"2022-04-08","objectID":"/mapping-star-qualimap-featurecounts/:4:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(3) Mapping (STAR+Qualimap+featureCounts)","uri":"/mapping-star-qualimap-featurecounts/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"5. Obtain counts data using featureCounts /home/akif/Downloads/subread-2.0.3-source/bin/featureCounts -s 2 -p -t gene -g gene_id -a /dir/annotation.gtf -o counts.txt *.bam Delete the columns (2-6) which are not necessary. cut -f1,7-100 ${WORKDIR}/count/count.txt \u003e ${WORKDIR}/count/featurecounts.txt ","date":"2022-04-08","objectID":"/mapping-star-qualimap-featurecounts/:5:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(3) Mapping (STAR+Qualimap+featureCounts)","uri":"/mapping-star-qualimap-featurecounts/"},{"categories":["Structure analysis"],"content":"Summary ‚ÄúIt is very easy to answer many fundamental biological questions; you just look at the thing!‚Äù ","date":"2022-04-08","objectID":"/structure-analysis-cryo-em/:0:0","tags":["Cryo-EM"],"title":"Structure analysis (Cryo-EM)","uri":"/structure-analysis-cryo-em/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"In this section, we are going to concatenate 4 read files from one sample into 1 and perform Fastqc, multiqc, and Trim_galore to check the quality.","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"Summary In this section, we are going to concatenate 4 read files from the same sample into 1 file and perform Fastqc, multiqc, and Trim_galore to check the quality of each read data. ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:0:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"1. Concatenation of raw read files First of all, the operating system (OS) I used is Linux Ubuntu 20.04.4. And what I have in my hand are 64 raw read fastq.gz files. What we need to do first is to concatenate 4 files into one, for example: File name (before) File name(after) LAB_273_17_‚Ä¶_L001_R1_001.fastq.gz LAB_273_17_R1.fastq.gz LAB_273_17_‚Ä¶_L002_R1_001.fastq.gz LAB_273_17_‚Ä¶_L003_R1_001.fastq.gz LAB_273_17_‚Ä¶_L004_R1_001.fastq.gz in Linux, open the terminal for name in *.fastq.gz; do printf '%s\\n' \"${name%_*_*_R[12]*}\" done | uniq | while read prefix; do cat \"$prefix\"*R1*.fastq.gz \u003e\"${prefix}_R1.fastq.gz\" cat \"$prefix\"*R2*.fastq.gz \u003e\"${prefix}_R2.fastq.gz\" done Then check whether they are concatenated or not. ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:1:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"2. Use fastqc to perform quality checks Here is the homepage for fastqc and you can easily follow the instructions. https://www.bioinformatics.babraham.ac.uk/projects/download.html#fastqc ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:2:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"2.1 installing Java Runtime Environment (JRE) sudo apt install default-jre Then check whether JRE is properly installed: java -version ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:2:1","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"2.2 installing Fastqc software sudo -i apt install fastqc fastqc -version ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:2:2","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"2.3 Run fastqc fastqc *.gz which means fastqc all files with .gz you will get one html file for 1 sample like XXXX_fastqc.html ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:2:3","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3. Using multiqc to summarize the results of fastqc ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:3:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3.1 installing conda https://docs.conda.io/projects/conda/en/latest/user-guide/install/linux.html ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:3:1","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3.2 installing python conda create --name py3.7 python=3.7 conda activate py3.7 python -version ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:3:2","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3.3 installing multiqc conda install -c bioconda -c conda-forge multiqc ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:3:3","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"3.4 Run multiqc multiqc . #run multiqc for all fastqc reults files (.html) ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:3:4","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":["RNA-seq data analysis","Protocols"],"content":"4. Discussion For detailed explanation of each result in fastqc and multiqc, I will generate another article for it~ üòâ ","date":"2022-04-06","objectID":"/preparation-of-clean-reads-data-for-rna-seq/:4:0","tags":["RNA-seq data analysis","Protocols"],"title":"RNA-seq protocol(1) Preparation of clean read data for RNA-seq data analysis","uri":"/preparation-of-clean-reads-data-for-rna-seq/"},{"categories":null,"content":"Hi! Welcome to this personal blog! üëã ","date":"0001-01-01","objectID":"/about/:0:0","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"Who am I? üë®‚Äçüî¨ I‚Äôm a student doing fundamental research in a molecular biology lab in Japan. I used transgenic mice üê≠ as well as cells to analyze unknown functions of proteins. I have a dream of experimental ‚öóÔ∏è -theoretical üíª collaboration! I want to generate a multi-scale analysis from the atomistic level to the animal model. ","date":"0001-01-01","objectID":"/about/:0:1","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"Education üë∂ Born in Shanghai, China üéí Graduated from Shanghai High School üè´ Graduated from the University of Tsukuba (Bachelor‚Äôs degree) üí¶ 5-year doctoral program in the University of Tsukuba (current) ","date":"0001-01-01","objectID":"/about/:0:2","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"Why I generate this personal blog? I‚Äôm a student who has a strong interest in the field of Bioinformatics! üòÅ Although I have no background in programming, and no concept of NGS, I have patience and passion. I‚Äôm very lucky that my lab supports me with powerful computing resources that I can easily start my dry analysis from 0. Thanks to several professors in Bioinformatics Lab for supporting me. In this blog, I aim to: Generate protocols for Bioinformatics analysis Record the problems and difficulties I met and the solutions for them Note new idea and knowledge from papers ","date":"0001-01-01","objectID":"/about/:0:3","tags":null,"title":"About me","uri":"/about/"},{"categories":null,"content":"Hobby üéØ üèÄ Basketball üéπ Piano üéÆ Video games ü§ñ Gundam ","date":"0001-01-01","objectID":"/about/:0:4","tags":null,"title":"About me","uri":"/about/"}]